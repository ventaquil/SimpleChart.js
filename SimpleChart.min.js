var SimpleChart=function(a){"use strict";function b(a,b){var d,c={minValue:1/0,maxValue:-(1/0),maxLength:0};return a.forEach(function(a,e){(void 0===b||b.visible[e])&&(a.length>c.maxLength&&(c.maxLength=a.length),d=h(a),c.minValue>d.min&&(c.minValue=d.min),c.maxValue<d.max&&(c.maxValue=d.max))}),void 0!==b&&b.options.startOnZero&&(c.minValue>0?c.minValue=0:c.maxValue<0&&(c.maxValue=0)),c}function c(){for(var a="0123456789ABCDEF".split(""),b="#",c=0;6>c;c++)b+=a[Math.floor(16*Math.random())];return b}function d(a){var b=a.canvas.area,c=a.canvas.context,d=a.helpers,f=a.lineText,g=a.options,h={x:-.5,y:-.5};c.fillStyle=c.strokeStyle="#000",c.lineWidth=1,c.font="8px Arial",c.translate(h.x,h.y);var i,j=b.start.x,k=b.end.y,l=b.height,m=b.width;g.showGrid||(l-=10,m-=10),d.minValue<0&&(k=d.maxValue<0?l:-d.minValue/(d.maxValue-d.minValue)*l,k=Math.abs(b.height-k),k+=b.start.y),Number(k)!==k||k%1===0||g.showGrid||(k+=.5),i=m/(d.maxLength-1);for(var n=0,o=d.maxLength;o>n;n++)g.showGrid?(c.beginPath(),c.moveTo(j,k-2),c.lineTo(j,k+2),c.stroke(),k!=b.end.y&&(c.beginPath(),c.moveTo(j,b.end.y-2),c.lineTo(j,b.end.y+2),c.stroke()),void 0!==f[n]&&c.fillText(f[n],j-Math.round(c.measureText(f[n]).width/2),k+13)):(c.beginPath(),c.moveTo(j,k-2),c.lineTo(j,k+2),c.stroke(),void 0!==f[n]&&c.fillText(f[n],j-Math.round(c.measureText(f[n]).width/2),k+13)),j+=i;if(c.beginPath(),c.moveTo(b.start.x,b.start.y),c.lineTo(b.start.x,b.end.y),c.stroke(),g.showGrid){for(e(a),c.beginPath(),c.moveTo(b.start.x,b.end.y),c.lineTo(b.end.x,b.end.y),c.stroke(),k!=b.end.y&&(c.beginPath(),c.moveTo(b.start.x,k),c.lineTo(b.end.x,k),c.stroke()),n=0,j=b.start.x;o>n;n++)c.beginPath(),c.moveTo(j,b.start.y-2),c.lineTo(j,b.start.y+2),c.stroke(),j+=i;c.beginPath(),c.moveTo(b.start.x,b.start.y),c.lineTo(b.end.x,b.start.y),c.stroke(),c.beginPath(),c.moveTo(b.end.x,b.start.y),c.lineTo(b.end.x,b.end.y),c.stroke()}else c.beginPath(),c.moveTo(b.start.x,k),c.lineTo(b.end.x,k),c.stroke(),c.beginPath(),c.moveTo(b.end.x-7,k-3),c.lineTo(b.end.x-7,k+3),c.lineTo(b.end.x,k),c.fill(),c.beginPath(),c.moveTo(b.start.x-3,b.start.y+7),c.lineTo(b.start.x+3,b.start.y+7),c.lineTo(b.start.x,b.start.y),c.fill();c.translate(-h.x,-h.y)}function e(a){var b=a.canvas.area,c=a.canvas.context,d=a.helpers,e=a.options,f=b.width;e.showGrid||(f-=10);var g,h=d.maxLength-1;g=f/h,c.strokeStyle="#CCC";for(var i=1,j=h;j>i;i++)c.beginPath(),c.moveTo(g*i+b.start.x,b.start.y),c.lineTo(g*i+b.start.x,b.end.y),c.stroke();c.strokeStyle="#000"}function f(a){var b=a.colors,c=a.labels,d=a.visible,e=document.getElementById(a.id+"-labels");if(null!==e){e.innerHTML="";var f;f=document.getElementById("SimpleChart-styles"),(null===f||void 0===f)&&(f=document.createElement("style"),f.id="SimpleChart-styles",f.type="text/css",f.innerHTML=".simplechart-label{font-family:Arial;font-size:12px;} .simplechart-label div {border-radius:3px;border-style:solid;border-width:2px;display:inline-block;height:5px;margin-right:5px;width:30px;} .simplechart-label div.unvisible {opacity:.5;} div.visible {opacity:1;}",document.getElementsByTagName("head")[0].appendChild(f));var g,h,i;c.forEach(function(c,f){h=document.createElement("div"),d[f]?h.className="visible":h.className="unvisible",h.style.borderColor=b[f].line,h.style.backgroundColor=b[f].point,i=document.createElement("span"),i.appendChild(document.createTextNode(c)),g=document.createElement("div"),g.className="simplechart-label",g.addEventListener("click",function(){a.toggleVisible(f)}),g.appendChild(h),g.appendChild(i),e.appendChild(g)})}}function g(a){var j,k,m,b=a.canvas.area,d=a.colors,e=a.canvas.context,f=a.helpers,g=a.options,h=a.points,i=a.visible,l={x:0,y:0};k=b.height,m=b.width,g.showGrid||(k-=10,m-=10),j=m/(f.maxLength-1);var n,o;h.forEach(function(a,g){if(i[g]){e.lineWidth=1,e.lineJoin="round",n=o=c(),void 0===d&&(d=new Array),void 0===d[g]?d[g]={line:null,point:null}:(void 0!==d[g].line&&(n=d[g].line),void 0!==d[g].point&&(o=d[g].point)),d[g].line=n,d[g].point=o,l.x=b.start.x;var g=0;e.beginPath(),a.forEach(function(a){return void 0===a&&(e.strokeStyle=n,e.stroke(),e.beginPath(),g=0),null===a||void 0===a?void(l.x+=j):(l.y=(a-f.minValue)/(f.maxValue-f.minValue)*k,l.y=Math.abs(b.height-l.y),0==g?e.moveTo(l.x,l.y+b.start.y):e.lineTo(l.x,l.y+b.start.y),l.x+=j,void g++)}),e.strokeStyle=n,e.stroke(),l.x=b.start.x,a.forEach(function(a){return null===a||void 0===a?void(l.x+=j):(l.y=(a-f.minValue)/(f.maxValue-f.minValue)*k,l.y=Math.abs(b.height-l.y),e.beginPath(),e.arc(l.x,l.y+b.start.y,1.5,0,2*Math.PI),e.fillStyle=o,e.fill(),void(l.x+=j))})}}),a.colors=d}function h(a){var b=1/0,c=-(1/0);return a.forEach(function(a){void 0!==a&&null!==a&&(a>c&&(c=a),b>a&&(b=a))}),{min:b,max:c}}function i(a){a.canvas.area={start:{x:15,y:15},end:{x:a.canvas.object.width-15,y:a.canvas.object.height-15},height:a.canvas.object.height-30,width:a.canvas.object.width-30}}function j(a,b){void 0===b&&(b=new Array),a.labels=b,a.points.forEach(function(b,c){void 0===a.labels[c]&&(a.labels[c]="Unnamed Label")})}function k(a,b){void 0===b&&(b=new Array);for(var c=a.helpers.maxLength,d=b.length;d>c;c++)delete b[c];a.lineText=b}function l(a,b){void 0!==b&&(b.fullSize===!0&&(a.options.fullSize=!0),b.showGrid===!0&&(a.options.showGrid=!0),b.startOnZero===!0&&(a.options.startOnZero=!0))}function m(a){var b=new Array;return a.forEach(function(a,c){b[c]=!0}),b}this.draw=function(){this.setFullSize(),i(this),this.paint()},this.paint=function(){d(this),g(this),f(this)},this.setFullSize=function(){var a=this.canvas.object.parentElement;if(this.options.fullSize){var b=window.getComputedStyle(a,null);this.canvas.object.width=a.offsetWidth-(parseFloat(b.paddingLeft)+parseFloat(b.borderLeftWidth))-(parseFloat(b.paddingLeft)+parseFloat(b.borderRightWidth)),void 0===a.style.height||null===a.style.height||""===a.style.height?this.canvas.object.height=.61803*this.canvas.object.width:this.canvas.object.height=parseFloat(a.style.height)}},this.setUnvisible=function(a){void 0!==this.visible[a]&&(this.visible[a]=!1,this.helpers=b(this.points,this),this.draw())},this.setVisible=function(a){void 0!==this.visible[a]&&(this.visible[a]=!0,this.helpers=b(this.points,this),this.draw())},this.toggleVisible=function(a){void 0!==this.visible[a]&&(this.visible[a]=!this.visible[a],this.helpers=b(this.points,this),this.draw())},this.id=a.id,this.canvas={},this.options={fullSize:!1,showGrid:!1,startOnZero:!1},this.colors=a.colors,this.visible=m(a.points),this.points=a.points,l(this,a.options),this.helpers=b(this.points,this),j(this,a.labels),k(this,a.lineText);var n=this;window.addEventListener("load",function(){n.canvas.object=document.getElementById(a.id),n.canvas.context=n.canvas.object.getContext("2d"),n.draw()}),window.addEventListener("resize",function(){n.draw()})};
